<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Reconocedor de Lengua de Se침as</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://kit.fontawesome.com/a2e0c5e6b3.js" crossorigin="anonymous"></script>
  <style>
    body {
      background: linear-gradient(to right, #667eea, #764ba2);
      min-height: 100vh;
      font-family: 'Segoe UI', sans-serif;
    }

    .container {
      max-width: 750px;
      margin-top: 60px;
    }

    .card {
      border: none;
      border-radius: 20px;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.2);
      background: #ffffff;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
      color: white;
    }

    .header h1 {
      font-weight: 700;
      font-size: 2.8rem;
    }

    .preview {
      max-width: 100%;
      height: auto;
      margin-top: 15px;
      border-radius: 12px;
      border: 1px solid #ddd;
    }

    #loadingSpinner {
      display: none;
    }

    .result-box {
      padding: 20px;
      border-radius: 12px;
      color: white;
      font-size: 1.2rem;
      text-align: center;
    }

    .result-low {
      background-color: #e74c3c;
    }

    .result-medium {
      background-color: #f1c40f;
      color: #333;
    }

    .result-high {
      background-color: #2ecc71;
    }
  </style>
</head>
<body>

  <div class="container">
    <div class="header">
      <h1><i class="fas fa-hand-sparkles"></i> Reconocimiento de Lengua de Se침as</h1>
      <p class="text-white-50">Sube o captura una imagen para predecir la letra</p>
    </div>

    <div class="card p-4">
      <form method="POST" enctype="multipart/form-data" onsubmit="showSpinner()">
        <div class="mb-3">
          <label class="form-label">Elige c칩mo subir la imagen:</label>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="inputType" id="uploadRadio" value="upload" checked onchange="toggleInput()">
            <label class="form-check-label" for="uploadRadio">
              Subir archivo
            </label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="radio" name="inputType" id="cameraRadio" value="camera" onchange="toggleInput()">
            <label class="form-check-label" for="cameraRadio">
              Usar c치mara
            </label>
          </div>

          <input class="form-control" type="file" name="image" id="fileInput" accept="image/*">
          <input class="form-control d-none" type="file" name="image" id="cameraInput" accept="image/*" capture="environment">
        </div>

        <button type="submit" class="btn btn-primary w-100">
          <i class="fas fa-magic me-1"></i> Predecir Letra
        </button>

        <div class="text-center mt-3" id="loadingSpinner">
          <div class="spinner-border text-primary" role="status"></div>
          <p class="mt-2">Analizando imagen...</p>
        </div>
      </form>

      {% if image_data %}
        <div class="text-center mt-4">
          <h5>Imagen procesada:</h5>
          <img src="{{ image_data }}" class="preview">
        </div>
      {% endif %}

      {% if result %}
        {% set confidence_pct = (confidence * 100) | round(2) %}
        {% set result_class = 'result-low' if confidence_pct < 60 else 'result-medium' if confidence_pct < 85 else 'result-high' %}
        <div class="mt-4 result-box {{ result_class }}">
          <i class="fas fa-check-circle fa-lg mb-2"></i>
          <h4>Letra Detectada: <strong>{{ result }}</strong></h4>
          <p>Confiabilidad: <strong>{{ confidence_pct }}%</strong></p>
        </div>
      {% endif %}
    </div>
  </div>

  <script>
    function toggleInput() {
      const upload = document.getElementById("uploadRadio").checked;
      document.getElementById("fileInput").classList.toggle("d-none", !upload);
      document.getElementById("fileInput").required = upload;
      document.getElementById("cameraInput").classList.toggle("d-none", upload);
      document.getElementById("cameraInput").required = !upload;
    }

    function showSpinner() {
      document.getElementById("loadingSpinner").style.display = "block";
    }

    toggleInput();
  </script>

</body>
</html>
